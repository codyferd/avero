<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Avero Viewer</title>
    <link rel="stylesheet" href="../../share/theme.css">
    <script src="../../share/cdn.js"></script>
    <script src="../../share/storage.js"></script>
    <style>
        [v-cloak] { display: none; }
        body, html { height: 100%; margin: 0; background: #050508; color: #fff; overflow: hidden; }
        .viewer-layout { display: grid; grid-template-rows: 60px 1fr 100px; height: 100vh; }
        .stage { display: flex; items-center justify-content: center; padding: 20px; overflow: auto; }
        .shelf { background: #08080c; border-top: 1px solid #222; display: flex; align-items: center; padding: 0 20px; gap: 10px; overflow-x: auto; }
        .thumb { min-width: 140px; height: 60px; background: #111; border: 1px solid #333; border-radius: 8px; display: flex; align-items: center; padding: 10px; cursor: pointer; font-size: 10px; font-weight: 800; text-transform: uppercase; }
        .thumb.active { border-color: #6366f1; background: rgba(99, 102, 241, 0.1); }
    </style>
</head>
<body class="avero-app">
<div id="app" v-cloak class="viewer-layout">
    <header class="flex items-center px-6 border-b border-white/5 justify-between">
        <span class="text-[10px] font-black text-indigo-500 uppercase tracking-widest">Avero Stage</span>
        <span class="text-[10px] opacity-30 uppercase">{{ currentFile?.name || 'Waiting...' }}</span>
    </header>

    <main class="stage">
        <div v-if="!currentFile" class="text-[10px] font-black opacity-10 tracking-[1em]">NO MEDIA SELECTED</div>
        <div v-else class="w-full h-full bg-[#0a0a0f] border border-[#222] rounded-xl p-8 font-mono text-xs whitespace-pre-wrap overflow-auto">
            {{ currentFile.content }}
        </div>
    </main>

    <footer class="shelf">
        <div v-for="f in averoFiles" :key="f.id" class="thumb" :class="{active: currentFile?.id === f.id}" @click="currentFile = f">
            <span class="mr-3">ðŸ“„</span> {{ f.name }}
        </div>
    </footer>
</div>

<script>
const { createApp, ref, onMounted } = Vue;
createApp({
    setup() {
        const averoFiles = ref([]);
        const currentFile = ref(null);
        const refresh = () => { averoFiles.value = AveroStorage.getFS().filter(f => !f.isDir); };
        onMounted(() => { refresh(); window.addEventListener('storage', refresh); });
        return { averoFiles, currentFile };
    }
}).mount('#app');
</script>
</body>
</html>
